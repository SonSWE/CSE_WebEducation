@using CSE_WebEducation
@using CommonLib
@using ObjectInfo;
@{
    List<CSE_GroupsInfo> _LstData = new List<CSE_GroupsInfo>();
    if (ViewBag.LstData != null)
    {
        _LstData = ViewBag.LstData;
    }

    int _record_on_page = CommonData.RecordsPerPage;
    if (ViewBag.Record_On_Page != null)
    {
        _record_on_page = ViewBag.Record_On_Page;
    }
    //decimal userType = ViewBag.UserType;

}
<h3 class="title">
    <span>Kết quả tìm kiếm</span>
    <div class="d-flex">
        @*<button class="render" onclick="exportData()">Kết xuất dữ liệu <img src="~/bidding_lib/img/icon-render.svg" alt="img"></button>*@
        <div class="show-record">
            Hiển thị
            <select onchange="onChange_Record_on_page()" id="cbo_record_on_page">
                @foreach (var item in AllCodeMemory.Allcode_GetByCdnameCdtype("DISPLAY", "RECORD_ON_PAGE"))
                {
                    <option @(item.CDVal == _record_on_page.ToString() ? "selected" : "") value="@item.CDVal">@item.Content</option>
                }
            </select>
            bản ghi
        </div>
    </div>
</h3>

<div class="over-flow-x ">
    <div class="wrapper-editor scroll-tbl tbl-record">
        <table id="test-tb">
            <thead>
                <tr>
                    <th scope="col" class="w-80px text-center">STT</th>
                    <th scope="col">Tên nhóm</th>
                    <th scope="col">Loại nhóm</th>
                    <th scope="col">Trạng thái</th>
                    <th scope="col">Số người thuộc nhóm</th>
                    <th scope="col">Mô tả</th>
                    <th scope="col">Ngày tạo</th>
                    <th scope="col">Người tạo</th>
                    <th scope="col" class="text-center">Chức năng</th>
                </tr>
            </thead>
            <tbody>
                @if (_LstData != null && _LstData.Count > 0)
                {
                    foreach (CSE_GroupsInfo item in _LstData)
                    {
                        <tr>

                            <td class="text-center">@item.STT</td>
                            <td>@item.Group_Name</td>
                            <td>@item.Group_Type_Text</td>
                            @if (@item.Status.ToUpper() == CSE_Group_Status.HieuLuc)
                            {
                                <td class="text-success">@item.Status_Text</td>
                            }
                            else if (@item.Status.ToUpper() == CSE_Group_Status.HetHieuLuc)
                            {
                                <td class="text-danger">@item.Status_Text</td>
                            }
                            <td class="text-right">@item.Count_User</td>
                            <td>@item.Note</td>
                            <td class="text-center">@item.Created_Date</td>
                            <td>@item.Created_By</td>
                            <td>
                                <a href="javascript:;" data-toggle="modal" data-target="#formViewUser" class="btn-function" onclick="LoadView('@item.Group_Id');">
                                    <span>
                                        <img class="imgbefore-hv" src="~/bidding_lib/img/icon-info.svg" alt="img">
                                    </span>
                                    <div class="name-function-fix">Xem</div>
                                </a>
                                <a href="javascript:;" class="btn-function" onclick="LoadEdit('@item.Group_Id')">
                                    <span>
                                        <img class="imgbefore-hv" src="~/bidding_lib/img/icon-edit.svg" alt="img">
                                    </span>
                                    <div class="name-function-fix">Sửa</div>
                                </a>

                                <a href="javascript:;" class="btn-function" onclick="delete_group(@item.Group_Id);">
                                    <span>
                                        <img class="imgbefore-hv" src="~/bidding_lib/img/icon-delete.svg" alt="img">

                                    </span>
                                    <div class="name-function-fix">Xóa</div>
                                </a>
                                <a href="javascript:;" onclick="LoadSetFunction(@item.Group_Id)" class="btn-function">
                                    <span>
                                        <img class="imgbefore-hv" src="~/bidding_lib/img/wrench.svg" alt="img">
                                    </span>
                                    <div class="name-function-fix">Phân quyền</div>
                                </a>

                                <a href="javascript:;" onclick="LoadGroupUser(@item.Group_Id)" class="btn-function">
                                    <span>
                                        <img class="imgbefore-hv" src="~/bidding_lib/img/users.svg" alt="img">
                                    </span>
                                    <div class="name-function-fix">Gán/ gỡ NSD</div>
                                </a>

                               @* <a href="javascript:;" onclick="unactive_Group('@item.Group_Id', '@Au_Group_Status.HetHieuLuc')" class="btn-function btn-function-last2">
                                    <span>
                                        <img class="imgbefore-hv" src="~/bidding_lib/img/icon-cancel.svg" alt="img">
                                    </span>
                                    <div class="name-function-fix">Hết hiệu lực</div>
                                </a>*@

                                @*@if (@item.Status.ToUpper() == Au_Group_Status.HieuLuc)
                                    {

                                    <a href="javascript:;" class="btn-function" onclick="goEdit('@item.Group_Id')">
                                    <span>
                                    <img class="imgbefore-hv" src="~/bidding_lib/img/icon-edit.svg" alt="img">
                                    </span>
                                    <div class="name-function-fix">Sửa</div>
                                    </a>

                                    <a href="javascript:;" class="btn-function" onclick="delete_AuGroup('@item.Group_Id');">
                                    <span>
                                    <img class="imgbefore-hv" src="~/bidding_lib/img/icon-delete.svg" alt="img">

                                    </span>
                                    <div class="name-function-fix">Xóa</div>
                                    </a>
                                    <a href="javascript:;" onclick="showFormSetUpFunction(@item.Group_Id)" class="btn-function">
                                    <span>
                                    <img class="imgbefore-hv" src="~/bidding_lib/img/wrench.svg" alt="img">
                                    </span>
                                    <div class="name-function-fix">Phân quyền</div>
                                    </a>

                                    <a href="javascript:;" onclick="location.href = '/nhom-nguoi-dung/xep-nhom-nguoi-dung/@item.Group_Id/@item.Group_Type'" class="btn-function">
                                    <span>
                                    <img class="imgbefore-hv" src="~/bidding_lib/img/users.svg" alt="img">

                                    </span>
                                    <div class="name-function-fix">Gán/ gỡ NSD</div>
                                    </a>
                                    <a href="javascript:;" onclick="unactive_Group('@item.Group_Id', '@Au_Group_Status.HetHieuLuc')" class="btn-function btn-function-last2">
                                    <span>
                                    <img class="imgbefore-hv" src="~/bidding_lib/img/icon-cancel.svg" alt="img">
                                    </span>
                                    <div class="name-function-fix">Hết hiệu lực</div>
                                    </a>


                                    }
                                    else if (@item.Status.ToUpper() == Au_Group_Status.HetHieuLuc)
                                    {

                                    <a href="javascript:;" class="btn-function btn-spacing"><div></div></a>

                                    <a href="javascript:;" class="btn-function" onclick="delete_AuGroup('@item.Group_Id');">
                                    <span>
                                    <img class="imgbefore-hv" src="~/bidding_lib/img/icon-delete.svg" alt="img">

                                    </span>
                                    <div class="name-function-fix">Xóa</div>
                                    </a>

                                    <a href="javascript:;" class="btn-function btn-spacing"><div></div></a>
                                    <a href="javascript:;" class="btn-function btn-spacing"><div></div></a>


                                    <a href="javascript:;" onclick="active_Group('@item.Group_Id', '@Au_Group_Status.HieuLuc')" class="btn-function">
                                    <span>
                                    <img class="imgbefore-hv" src="~/bidding_lib/img/icon-reset.svg" alt="img">
                                    </span>
                                    <div class="name-function-fix">Kích hoạt</div>
                                    </a>

                                    }*@
                            </td>
                        </tr>
                    }
                }
                else
                {
                    <tr>

                        <td colspan="10" class="text-left">Không có dữ liệu</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<div class="foot-record">
    @Html.Raw(ViewBag.Paging)
</div>

<script>
    //$(function() {
    //     //inittitlefuction();
    //})

    //window.onload = funcFixTable();
    //window.onresize = funcFixTable();
    //function funcFixTable() {
    //    let options = {
    //        fnDrawCallback: function () {
    //            if (window.currentScrollLeft > 0) {
    //                document.getElementById("test-tb").parentElement.scrollLeft = window.currentScrollLeft;
    //            }
    //            //
    //            document.getElementById("test-tb").parentElement.addEventListener("scroll", function () {
    //                window.currentScrollLeft = this.scrollLeft;
    //            });
    //        }
    //    };
    //    let fixColumnOptions = {
    //        leftColumns: 0,
    //        rightColumns: 1
    //    };
    //    CreateFixedTable('#test-tb', fixColumnOptions, options);
    //}
</script>